function cov_2prt207ro6(){var path="C:\\Users\\Marc Salas\\bootcamp2\\skylab-bootcamp-202001\\staff\\marc-salas\\karmark\\karmark-api\\logic\\register-user.spec.js";var hash="da036bff7909541fca8a8e68facc541bd09703cc";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\Marc Salas\\bootcamp2\\skylab-bootcamp-202001\\staff\\marc-salas\\karmark\\karmark-api\\logic\\register-user.spec.js",statementMap:{"0":{start:{line:1,column:0},end:{line:1,column:26}},"1":{start:{line:3,column:19},end:{line:3,column:34}},"2":{start:{line:4,column:19},end:{line:4,column:23}},"3":{start:{line:5,column:39},end:{line:5,column:62}},"4":{start:{line:6,column:42},end:{line:6,column:67}},"5":{start:{line:7,column:25},end:{line:7,column:38}},"6":{start:{line:8,column:15},end:{line:8,column:34}},"7":{start:{line:10,column:38},end:{line:10,column:45}},"8":{start:{line:12,column:0},end:{line:72,column:2}},"9":{start:{line:15,column:4},end:{line:18,column:5}},"10":{start:{line:16,column:8},end:{line:17,column:42}},"11":{start:{line:17,column:24},end:{line:17,column:41}},"12":{start:{line:19,column:4},end:{line:24,column:6}},"13":{start:{line:20,column:8},end:{line:20,column:33}},"14":{start:{line:21,column:8},end:{line:21,column:39}},"15":{start:{line:22,column:8},end:{line:22,column:41}},"16":{start:{line:23,column:8},end:{line:23,column:41}},"17":{start:{line:26,column:4},end:{line:47,column:6}},"18":{start:{line:27,column:23},end:{line:27,column:76}},"19":{start:{line:29,column:8},end:{line:29,column:35}},"20":{start:{line:30,column:8},end:{line:30,column:38}},"21":{start:{line:32,column:8},end:{line:46,column:68}},"22":{start:{line:36,column:16},end:{line:36,column:37}},"23":{start:{line:37,column:16},end:{line:37,column:49}},"24":{start:{line:38,column:16},end:{line:38,column:48}},"25":{start:{line:39,column:16},end:{line:39,column:54}},"26":{start:{line:40,column:16},end:{line:40,column:56}},"27":{start:{line:41,column:16},end:{line:41,column:59}},"28":{start:{line:44,column:16},end:{line:44,column:62}},"29":{start:{line:46,column:35},end:{line:46,column:67}},"30":{start:{line:48,column:4},end:{line:57,column:6}},"31":{start:{line:49,column:8},end:{line:49,column:18}},"32":{start:{line:50,column:8},end:{line:50,column:112}},"33":{start:{line:50,column:21},end:{line:50,column:69}},"34":{start:{line:51,column:8},end:{line:51,column:21}},"35":{start:{line:52,column:8},end:{line:52,column:115}},"36":{start:{line:52,column:21},end:{line:52,column:69}},"37":{start:{line:53,column:8},end:{line:53,column:22}},"38":{start:{line:54,column:8},end:{line:54,column:116}},"39":{start:{line:54,column:21},end:{line:54,column:69}},"40":{start:{line:55,column:8},end:{line:55,column:22}},"41":{start:{line:56,column:8},end:{line:56,column:116}},"42":{start:{line:56,column:21},end:{line:56,column:69}},"43":{start:{line:58,column:4},end:{line:70,column:6}},"44":{start:{line:59,column:21},end:{line:69,column:14}},"45":{start:{line:61,column:29},end:{line:68,column:22}},"46":{start:{line:62,column:32},end:{line:62,column:74}},"47":{start:{line:64,column:24},end:{line:64,column:46}},"48":{start:{line:65,column:24},end:{line:65,column:71}},"49":{start:{line:66,column:24},end:{line:66,column:103}},"50":{start:{line:71,column:4},end:{line:71,column:83}},"51":{start:{line:71,column:16},end:{line:71,column:82}},"52":{start:{line:71,column:60},end:{line:71,column:81}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:12,column:25},end:{line:12,column:26}},loc:{start:{line:12,column:31},end:{line:72,column:1}},line:12},"1":{name:"(anonymous_1)",decl:{start:{line:15,column:11},end:{line:15,column:12}},loc:{start:{line:16,column:8},end:{line:17,column:42}},line:16},"2":{name:"(anonymous_2)",decl:{start:{line:17,column:18},end:{line:17,column:19}},loc:{start:{line:17,column:24},end:{line:17,column:41}},line:17},"3":{name:"(anonymous_3)",decl:{start:{line:19,column:15},end:{line:19,column:16}},loc:{start:{line:19,column:21},end:{line:24,column:5}},line:19},"4":{name:"(anonymous_4)",decl:{start:{line:26,column:45},end:{line:26,column:46}},loc:{start:{line:26,column:57},end:{line:47,column:5}},line:26},"5":{name:"(anonymous_5)",decl:{start:{line:34,column:18},end:{line:34,column:19}},loc:{start:{line:34,column:26},end:{line:45,column:13}},line:34},"6":{name:"(anonymous_6)",decl:{start:{line:46,column:18},end:{line:46,column:19}},loc:{start:{line:46,column:35},end:{line:46,column:67}},line:46},"7":{name:"(anonymous_7)",decl:{start:{line:48,column:64},end:{line:48,column:65}},loc:{start:{line:48,column:70},end:{line:57,column:5}},line:48},"8":{name:"(anonymous_8)",decl:{start:{line:50,column:15},end:{line:50,column:16}},loc:{start:{line:50,column:21},end:{line:50,column:69}},line:50},"9":{name:"(anonymous_9)",decl:{start:{line:52,column:15},end:{line:52,column:16}},loc:{start:{line:52,column:21},end:{line:52,column:69}},line:52},"10":{name:"(anonymous_10)",decl:{start:{line:54,column:15},end:{line:54,column:16}},loc:{start:{line:54,column:21},end:{line:54,column:69}},line:54},"11":{name:"(anonymous_11)",decl:{start:{line:56,column:15},end:{line:56,column:16}},loc:{start:{line:56,column:21},end:{line:56,column:69}},line:56},"12":{name:"(anonymous_12)",decl:{start:{line:58,column:67},end:{line:58,column:68}},loc:{start:{line:58,column:79},end:{line:70,column:5}},line:58},"13":{name:"(anonymous_13)",decl:{start:{line:60,column:18},end:{line:60,column:19}},loc:{start:{line:60,column:30},end:{line:69,column:13}},line:60},"14":{name:"(anonymous_14)",decl:{start:{line:62,column:26},end:{line:62,column:27}},loc:{start:{line:62,column:32},end:{line:62,column:74}},line:62},"15":{name:"(anonymous_15)",decl:{start:{line:63,column:27},end:{line:63,column:28}},loc:{start:{line:63,column:38},end:{line:68,column:21}},line:63},"16":{name:"(anonymous_16)",decl:{start:{line:71,column:10},end:{line:71,column:11}},loc:{start:{line:71,column:16},end:{line:71,column:82}},line:71},"17":{name:"(anonymous_17)",decl:{start:{line:71,column:54},end:{line:71,column:55}},loc:{start:{line:71,column:60},end:{line:71,column:81}},line:71}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},b:{},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"da036bff7909541fca8a8e68facc541bd09703cc"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_2prt207ro6=function(){return actualCoverage;};return actualCoverage;}cov_2prt207ro6();cov_2prt207ro6().s[0]++;require('dotenv').config();const{expect}=(cov_2prt207ro6().s[1]++,require('chai'));const{random}=(cov_2prt207ro6().s[2]++,Math);const{mongoose,models:{User}}=(cov_2prt207ro6().s[3]++,require('karmark-data'));const{ContentError,NotAllowedError}=(cov_2prt207ro6().s[4]++,require('karmark-errors'));const{registerUser}=(cov_2prt207ro6().s[5]++,require('./'));const bcrypt=(cov_2prt207ro6().s[6]++,require('bcryptjs'));const{env:{TEST_MONGODB_URL}}=(cov_2prt207ro6().s[7]++,process);cov_2prt207ro6().s[8]++;describe('registerUser',()=>{cov_2prt207ro6().f[0]++;let name,surname,username,password;cov_2prt207ro6().s[9]++;before(()=>{cov_2prt207ro6().f[1]++;cov_2prt207ro6().s[10]++;return mongoose.connect(TEST_MONGODB_URL,{useNewUrlParser:true,useUnifiedTopology:true}).then(()=>{cov_2prt207ro6().f[2]++;cov_2prt207ro6().s[11]++;return User.deleteMany();});});cov_2prt207ro6().s[12]++;beforeEach(()=>{cov_2prt207ro6().f[3]++;cov_2prt207ro6().s[13]++;name=`name-${random()}`;cov_2prt207ro6().s[14]++;surname=`surname-${random()}`;cov_2prt207ro6().s[15]++;username=`username-${random()}`;cov_2prt207ro6().s[16]++;password=`password-${random()}`;});cov_2prt207ro6().s[17]++;it('should succed on correct user data',async()=>{cov_2prt207ro6().f[4]++;const result=(cov_2prt207ro6().s[18]++,await registerUser(name,surname,username,password));cov_2prt207ro6().s[19]++;expect(result).to.not.exist;cov_2prt207ro6().s[20]++;expect(result).to.be.undefined;cov_2prt207ro6().s[21]++;return User.findOne({username}).then(user=>{cov_2prt207ro6().f[5]++;cov_2prt207ro6().s[22]++;expect(user).to.exist;cov_2prt207ro6().s[23]++;expect(user.id).to.be.a('string');cov_2prt207ro6().s[24]++;expect(user.name).to.equal(name);cov_2prt207ro6().s[25]++;expect(user.surname).to.equal(surname);cov_2prt207ro6().s[26]++;expect(user.username).to.equal(username);cov_2prt207ro6().s[27]++;expect(user.created).to.be.instanceOf(Date);cov_2prt207ro6().s[28]++;return bcrypt.compare(password,user.password);}).then(validPassword=>{cov_2prt207ro6().f[6]++;cov_2prt207ro6().s[29]++;return expect(validPassword).to.be.true;});});cov_2prt207ro6().s[30]++;it('should throw a ContenrError if one parameter is empty',()=>{cov_2prt207ro6().f[7]++;cov_2prt207ro6().s[31]++;_name='';cov_2prt207ro6().s[32]++;expect(()=>{cov_2prt207ro6().f[8]++;cov_2prt207ro6().s[33]++;return registerUser(_name,surname,username,password);}).to.throw(ContentError,`name is empty`);cov_2prt207ro6().s[34]++;_surname='';cov_2prt207ro6().s[35]++;expect(()=>{cov_2prt207ro6().f[9]++;cov_2prt207ro6().s[36]++;return registerUser(name,_surname,username,password);}).to.throw(ContentError,`surname is empty`);cov_2prt207ro6().s[37]++;_username='';cov_2prt207ro6().s[38]++;expect(()=>{cov_2prt207ro6().f[10]++;cov_2prt207ro6().s[39]++;return registerUser(name,surname,_username,password);}).to.throw(ContentError,`username is empty`);cov_2prt207ro6().s[40]++;_password='';cov_2prt207ro6().s[41]++;expect(()=>{cov_2prt207ro6().f[11]++;cov_2prt207ro6().s[42]++;return registerUser(name,surname,username,_password);}).to.throw(ContentError,`password is empty`);});cov_2prt207ro6().s[43]++;it('should throw a NotAllowedError if the user already exist',async()=>{cov_2prt207ro6().f[12]++;const user=(cov_2prt207ro6().s[44]++,await registerUser(name,surname,username,password).then(async()=>{cov_2prt207ro6().f[13]++;const _user=(cov_2prt207ro6().s[45]++,await registerUser(name,surname,username,password).then(()=>{cov_2prt207ro6().f[14]++;cov_2prt207ro6().s[46]++;return console.log('should not reach this point');}).catch(error=>{cov_2prt207ro6().f[15]++;cov_2prt207ro6().s[47]++;expect(error).to.exist;cov_2prt207ro6().s[48]++;expect(error).to.be.instanceOf(NotAllowedError);cov_2prt207ro6().s[49]++;expect(error.message).to.equal(`user with username ${username} already exists`);}));}));});cov_2prt207ro6().s[50]++;after(()=>{cov_2prt207ro6().f[16]++;cov_2prt207ro6().s[51]++;return Promise.all([User.deleteMany()]).then(()=>{cov_2prt207ro6().f[17]++;cov_2prt207ro6().s[52]++;return mongoose.disconnect();});});});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlZ2lzdGVyLXVzZXIuc3BlYy5qcyJdLCJuYW1lcyI6WyJyZXF1aXJlIiwiY29uZmlnIiwiZXhwZWN0IiwicmFuZG9tIiwiTWF0aCIsIm1vbmdvb3NlIiwibW9kZWxzIiwiVXNlciIsIkNvbnRlbnRFcnJvciIsIk5vdEFsbG93ZWRFcnJvciIsInJlZ2lzdGVyVXNlciIsImJjcnlwdCIsImVudiIsIlRFU1RfTU9OR09EQl9VUkwiLCJwcm9jZXNzIiwiZGVzY3JpYmUiLCJuYW1lIiwic3VybmFtZSIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJiZWZvcmUiLCJjb25uZWN0IiwidXNlTmV3VXJsUGFyc2VyIiwidXNlVW5pZmllZFRvcG9sb2d5IiwidGhlbiIsImRlbGV0ZU1hbnkiLCJiZWZvcmVFYWNoIiwiaXQiLCJyZXN1bHQiLCJ0byIsIm5vdCIsImV4aXN0IiwiYmUiLCJ1bmRlZmluZWQiLCJmaW5kT25lIiwidXNlciIsImlkIiwiYSIsImVxdWFsIiwiY3JlYXRlZCIsImluc3RhbmNlT2YiLCJEYXRlIiwiY29tcGFyZSIsInZhbGlkUGFzc3dvcmQiLCJ0cnVlIiwiX25hbWUiLCJ0aHJvdyIsIl9zdXJuYW1lIiwiX3VzZXJuYW1lIiwiX3Bhc3N3b3JkIiwiX3VzZXIiLCJjb25zb2xlIiwibG9nIiwiY2F0Y2giLCJlcnJvciIsIm1lc3NhZ2UiLCJhZnRlciIsIlByb21pc2UiLCJhbGwiLCJkaXNjb25uZWN0Il0sIm1hcHBpbmdzIjoiczBOQUFBQSxPQUFPLENBQUMsUUFBRCxDQUFQLENBQWtCQyxNQUFsQixHQUVBLEtBQU0sQ0FBRUMsTUFBRiwyQkFBYUYsT0FBTyxDQUFDLE1BQUQsQ0FBcEIsQ0FBTixDQUNBLEtBQU0sQ0FBRUcsTUFBRiwyQkFBYUMsSUFBYixDQUFOLENBQ0EsS0FBTSxDQUFFQyxRQUFGLENBQVlDLE1BQU0sQ0FBRSxDQUFFQyxJQUFGLENBQXBCLDJCQUFpQ1AsT0FBTyxDQUFDLGNBQUQsQ0FBeEMsQ0FBTixDQUNBLEtBQU0sQ0FBRVEsWUFB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Q0FBUiIsInNvdXJjZXNDb250ZW50IjpbInJlcXVpcmUoJ2RvdGVudicpLmNvbmZpZygpXHJcblxyXG5jb25zdCB7IGV4cGVjdCB9ID0gcmVxdWlyZSgnY2hhaScpXHJcbmNvbnN0IHsgcmFuZG9tIH0gPSBNYXRoXHJcbmNvbnN0IHsgbW9uZ29vc2UsIG1vZGVsczogeyBVc2VyIH0gfSA9IHJlcXVpcmUoJ2thcm1hcmstZGF0YScpXHJcbmNvbnN0IHsgQ29udGVudEVycm9yLCBOb3RBbGxvd2VkRXJyb3IgfSA9IHJlcXVpcmUoJ2thcm1hcmstZXJyb3JzJylcclxuY29uc3QgeyByZWdpc3RlclVzZXIgfSA9IHJlcXVpcmUoJy4vJylcclxuY29uc3QgYmNyeXB0ID0gcmVxdWlyZSgnYmNyeXB0anMnKVxyXG5cclxuY29uc3QgeyBlbnY6IHsgVEVTVF9NT05HT0RCX1VSTCB9IH0gPSBwcm9jZXNzO1xyXG5cclxuZGVzY3JpYmUoJ3JlZ2lzdGVyVXNlcicsICgpID0+IHtcclxuICAgIGxldCBuYW1lLCBzdXJuYW1lLCB1c2VybmFtZSwgcGFzc3dvcmRcclxuXHJcbiAgICBiZWZvcmUoKCkgPT5cclxuICAgICAgICBtb25nb29zZS5jb25uZWN0KFRFU1RfTU9OR09EQl9VUkwsIHsgdXNlTmV3VXJsUGFyc2VyOiB0cnVlLCB1c2VVbmlmaWVkVG9wb2xvZ3k6IHRydWUgfSlcclxuICAgICAgICAgICAgLnRoZW4oKCkgPT4gVXNlci5kZWxldGVNYW55KCkpXHJcbiAgICApXHJcbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgICAgICBuYW1lID0gYG5hbWUtJHtyYW5kb20oKX1gXHJcbiAgICAgICAgc3VybmFtZSA9IGBzdXJuYW1lLSR7cmFuZG9tKCl9YFxyXG4gICAgICAgIHVzZXJuYW1lID0gYHVzZXJuYW1lLSR7cmFuZG9tKCl9YFxyXG4gICAgICAgIHBhc3N3b3JkID0gYHBhc3N3b3JkLSR7cmFuZG9tKCl9YFxyXG4gICAgfSlcclxuXHJcbiAgICBpdCgnc2hvdWxkIHN1Y2NlZCBvbiBjb3JyZWN0IHVzZXIgZGF0YScsIGFzeW5jICgpID0+IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZWdpc3RlclVzZXIobmFtZSwgc3VybmFtZSwgdXNlcm5hbWUsIHBhc3N3b3JkKVxyXG5cclxuICAgICAgICBleHBlY3QocmVzdWx0KS50by5ub3QuZXhpc3RcclxuICAgICAgICBleHBlY3QocmVzdWx0KS50by5iZS51bmRlZmluZWRcclxuXHJcbiAgICAgICAgcmV0dXJuIFVzZXIuZmluZE9uZSh7IHVzZXJuYW1lIH0pXHJcblxyXG4gICAgICAgICAgICAudGhlbih1c2VyID0+IHtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgZXhwZWN0KHVzZXIpLnRvLmV4aXN0XHJcbiAgICAgICAgICAgICAgICBleHBlY3QodXNlci5pZCkudG8uYmUuYSgnc3RyaW5nJylcclxuICAgICAgICAgICAgICAgIGV4cGVjdCh1c2VyLm5hbWUpLnRvLmVxdWFsKG5hbWUpXHJcbiAgICAgICAgICAgICAgICBleHBlY3QodXNlci5zdXJuYW1lKS50by5lcXVhbChzdXJuYW1lKVxyXG4gICAgICAgICAgICAgICAgZXhwZWN0KHVzZXIudXNlcm5hbWUpLnRvLmVxdWFsKHVzZXJuYW1lKVxyXG4gICAgICAgICAgICAgICAgZXhwZWN0KHVzZXIuY3JlYXRlZCkudG8uYmUuaW5zdGFuY2VPZihEYXRlKVxyXG4gICAgICAgICAgIFxyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBiY3J5cHQuY29tcGFyZShwYXNzd29yZCwgdXNlci5wYXNzd29yZClcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4odmFsaWRQYXNzd29yZCA9PiBleHBlY3QodmFsaWRQYXNzd29yZCkudG8uYmUudHJ1ZSlcclxuICAgIH0pXHJcbiAgICBpdCgnc2hvdWxkIHRocm93IGEgQ29udGVuckVycm9yIGlmIG9uZSBwYXJhbWV0ZXIgaXMgZW1wdHknLCAoKSA9PiB7XHJcbiAgICAgICAgX25hbWUgPSAnJ1xyXG4gICAgICAgIGV4cGVjdCgoKSA9PiByZWdpc3RlclVzZXIoX25hbWUsIHN1cm5hbWUsIHVzZXJuYW1lLCBwYXNzd29yZCkpLnRvLnRocm93KENvbnRlbnRFcnJvciwgKGBuYW1lIGlzIGVtcHR5YCkpXHJcbiAgICAgICAgX3N1cm5hbWUgPSAnJ1xyXG4gICAgICAgIGV4cGVjdCgoKSA9PiByZWdpc3RlclVzZXIobmFtZSwgX3N1cm5hbWUsIHVzZXJuYW1lLCBwYXNzd29yZCkpLnRvLnRocm93KENvbnRlbnRFcnJvciwgKGBzdXJuYW1lIGlzIGVtcHR5YCkpXHJcbiAgICAgICAgX3VzZXJuYW1lID0gJydcclxuICAgICAgICBleHBlY3QoKCkgPT4gcmVnaXN0ZXJVc2VyKG5hbWUsIHN1cm5hbWUsIF91c2VybmFtZSwgcGFzc3dvcmQpKS50by50aHJvdyhDb250ZW50RXJyb3IsIChgdXNlcm5hbWUgaXMgZW1wdHlgKSlcclxuICAgICAgICBfcGFzc3dvcmQgPSAnJ1xyXG4gICAgICAgIGV4cGVjdCgoKSA9PiByZWdpc3RlclVzZXIobmFtZSwgc3VybmFtZSwgdXNlcm5hbWUsIF9wYXNzd29yZCkpLnRvLnRocm93KENvbnRlbnRFcnJvciwgKGBwYXNzd29yZCBpcyBlbXB0eWApKVxyXG4gICAgfSlcclxuICAgIGl0KCdzaG91bGQgdGhyb3cgYSBOb3RBbGxvd2VkRXJyb3IgaWYgdGhlIHVzZXIgYWxyZWFkeSBleGlzdCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgcmVnaXN0ZXJVc2VyKG5hbWUsIHN1cm5hbWUsIHVzZXJuYW1lLCBwYXNzd29yZClcclxuICAgICAgICAgICAgLnRoZW4oYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICBjb25zdCBfdXNlciA9IGF3YWl0IHJlZ2lzdGVyVXNlcihuYW1lLCBzdXJuYW1lLCB1c2VybmFtZSwgcGFzc3dvcmQpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4gY29uc29sZS5sb2coJ3Nob3VsZCBub3QgcmVhY2ggdGhpcyBwb2ludCcpKVxyXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGVycm9yKS50by5leGlzdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBleHBlY3QoZXJyb3IpLnRvLmJlLmluc3RhbmNlT2YoTm90QWxsb3dlZEVycm9yKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBleHBlY3QoZXJyb3IubWVzc2FnZSkudG8uZXF1YWwoYHVzZXIgd2l0aCB1c2VybmFtZSAke3VzZXJuYW1lfSBhbHJlYWR5IGV4aXN0c2ApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICB9KVxyXG4gICAgYWZ0ZXIoKCkgPT4gUHJvbWlzZS5hbGwoW1VzZXIuZGVsZXRlTWFueSgpXSkudGhlbigoKSA9PiBtb25nb29zZS5kaXNjb25uZWN0KCkpKVxyXG59KSJdfQ==